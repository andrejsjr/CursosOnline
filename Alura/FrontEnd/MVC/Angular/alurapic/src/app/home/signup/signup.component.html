<h4 class="text-center"> Register to embrace a new world!</h4>

<!-- 
    Usando a diretiva formGroup com data biding 
    com a propriedade signupForm para dizer que
    ele signupForm é quem vai controlar as validações
    do formulário.

    Event Binding com o evento submit para que
    ao submeter o formulário, seja executado o
    método login().
 -->
<form [formGroup]="signupForm" class="form mt-4" (submit)="signup()">
    <!--
        A string atribuida a formControlName
        precisa bater com:

        this.signupForm = this.formBuilder.group({
            email: ['',
                [
                    Validators.required,
                    Validators.email
                ]
            ],            
            
            fullName: ['', 
                [
                    Validators.required,
                    Validators.minLength(2),
                    Validators.maxLength(40)
                ]
            ],
            
            userName: ['', 
                [
                    Validators.required,
                    Validators.pattern(/^[a-z0-9_\-]+$/),
                    Validators.minLength(2),
                    Validators.maxLength(30)
                ]
            ],

            password: ['', 
                [
                    Validators.required,
                    Validators.minLength(8),
                    Validators.maxLength(14)
                ]
            ],
        })
    -->
    
    <div class="form-group">
        <input #emailInput formControlName="email" placeholder="email" class="form-control" autofocus >
        <ap-vmessage
            *ngIf="signupForm.get('email').errors?.required"
            text="Email is required!">
        </ap-vmessage>
        <ap-vmessage
            *ngIf="signupForm.get('email').errors?.email"
            text="Invalid e-mail!">
        </ap-vmessage>
    </div>

    <div class="form-group">
        <input formControlName="fullName" placeholder="full name" class="form-control">
        <ap-vmessage
            *ngIf="signupForm.get('fullName').errors?.required"
            text="Full name is required!">
        </ap-vmessage>
        <ap-vmessage
            *ngIf="signupForm.get('fullName').errors?.minlength"
            text="Mininum length is 2!">
        </ap-vmessage>
        <ap-vmessage
            *ngIf="signupForm.get('fullName').errors?.maxlength"
            text="Maximum length is 40!">
        </ap-vmessage>
    </div>

    <div class="form-group">
        <input formControlName="userName" placeholder="user name" class="form-control">
        <ap-vmessage
            *ngIf="signupForm.get('userName').errors?.required"
            text="User name is required!">
        </ap-vmessage>
        <ap-vmessage
            *ngIf="signupForm.get('userName').errors?.minlength"
            text="Mininum length is 2!">
        </ap-vmessage>
        <ap-vmessage
            *ngIf="signupForm.get('userName').errors?.maxlength"
            text="Maximum length is 30!">
        </ap-vmessage>
        <!-- <ap-vmessage
            *ngIf="signupForm.get('userName').errors?.pattern"
            text="Must be lower case!">
        </ap-vmessage> -->
        <!-- 
            Referenciaremos o Validator customizado
            apenas para exemplificar como funciona.
         -->
        <ap-vmessage
            *ngIf="signupForm.get('userName').errors?.lowerCase"
            text="Must be lower case!">
        </ap-vmessage>
        <ap-vmessage
            *ngIf="signupForm.get('userName').errors?.userNameTaken"
            text="Username already taken">
        </ap-vmessage>
        <small *ngIf="signupForm.get('userName').valid" class="text-success">User available</small>
    </div>

    <div class="form-group">
        <input formControlName="password" type="password" placeholder="password" class="form-control">
        <ap-vmessage
            *ngIf="signupForm.get('password').errors?.required"
            text="Password is required!">
        </ap-vmessage>
        <ap-vmessage
            *ngIf="signupForm.get('password').errors?.minlength"
            text="Mininum length is 8!">
        </ap-vmessage>
        <ap-vmessage
            *ngIf="signupForm.get('password').errors?.maxlength"
            text="Maximum length is 18!">
        </ap-vmessage>
    </div>

    <!-- 
        Quando precisamos testar se um formulário está
        válido quando este possui validações assíncronas,
        além do teste normal (signupForm.valid),
        precisamos testar se o mesmo ainda possui
        alguma validação assíncrona rodando (signupForm.pending).
     -->
     <button [disabled]="signupForm.invalid || signupForm.pending" class="btn btn-primary btn-block">Register</button>

    <p>Already a user? <a [routerLink]="['']">Sign In!</a></p>
</form>